datasource db {
  provider          = "postgres"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = "native"
}

model User {
  id Int @id @unique @default(autoincrement())

  email               String    @unique
  hashedPassword      String    @default("")
  salt                String    @default("")
  resetToken          String?
  resetTokenExpiresAt DateTime?

  name  String @default("")
  roles String @default("guest") // developer, standard, guest

  notes Note[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Note {
  id   Int    @id @default(autoincrement())
  body String

  author   User? @relation(fields: [authorId], references: [id])
  authorId Int?  @default(1)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // use to match currentUser.id and author to help keep notes private by default
  @@unique([authorId, id])
}
